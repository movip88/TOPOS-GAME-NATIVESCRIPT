"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var nativescript_audio_player_1 = require("nativescript-audio-player");
var TopoComponent = /** @class */ (function () {
    function TopoComponent() {
        this.puntos = 0;
        this.estadoJuego = true;
        this.vidas = Array(5);
        this.id = null;
        this.forats = [];
        this.forat = "forat";
        this.topo = "topo";
        this.tiempo = 0;
        this.altura = 0;
    }
    TopoComponent.prototype.ngOnInit = function () {
    };
    TopoComponent.prototype.iniciarJuego = function () {
        this.estadoJuego = false;
        this.vidas = Array(5);
        this.puntos = 0;
        this.forats = Array(3).fill(this.forat);
        this.tiempo = 650;
        this.altura = 200;
        this.inciarTimer();
        this.audioPlayer = new nativescript_audio_player_1.TNSPlayer();
    };
    TopoComponent.prototype.inciarTimer = function () {
        var _this = this;
        this.id = setInterval(function () {
            if (_this.vidas.length == 0) {
                for (var i = 0; i < _this.forats.length; i++) {
                    _this.forats[i] = _this.forat;
                }
                clearInterval(_this.id);
                _this.estadoJuego = true;
                _this.audioPlayer.initFromFile({
                    audioFile: '~/audio/perder.mp3',
                    loop: false
                });
                _this.audioPlayer.play();
            }
            else {
                var filas = Math.floor(_this.puntos / 100);
                if (_this.puntos > 100 && _this.puntos <= 700 && filas == _this.forats.length / 3) {
                    _this.forats.splice(_this.forats.length - 1, 0, _this.forat, _this.forat, _this.forat);
                    _this.altura += 200;
                    _this.tiempo -= 50;
                    clearInterval(_this.id);
                    _this.inciarTimer();
                }
                var pos = Math.floor(Math.random() * _this.forats.length);
                _this.cambiarEstadoAgujero(pos);
            }
        }, this.tiempo);
    };
    TopoComponent.prototype.cambiarEstadoAgujero = function (pos) {
        //this.forats[pos] = this.forats[pos]=="forat"?"topo":"forat";
        if (this.forats[pos] == this.topo) {
            this.forats[pos] = this.forat;
            if (this.vidas.length > 0) {
                this.vidas.length--;
            }
        }
        else {
            this.forats[pos] = this.topo;
        }
    };
    TopoComponent.prototype.aplastarTopo = function (pos) {
        if (!this.estadoJuego) {
            if (this.forats[pos] == this.topo) {
                this.audioPlayer.initFromFile({
                    audioFile: '~/audio/aplastar.mp3',
                    loop: false
                });
                this.audioPlayer.play();
                this.puntos += 15;
                this.forats[pos] = this.forat;
            }
            else {
                this.audioPlayer.initFromFile({
                    audioFile: '~/audio/fail.mp3',
                    loop: false
                });
                this.audioPlayer.play();
                this.puntos -= 5;
            }
        }
    };
    TopoComponent = __decorate([
        core_1.Component({
            selector: "topos_tag",
            moduleId: module.id,
            templateUrl: "topos.component.html",
            styleUrls: ["topos.component.css"]
        })
    ], TopoComponent);
    return TopoComponent;
}());
exports.TopoComponent = TopoComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9wb3MuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsidG9wb3MuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsc0NBQWtEO0FBQ2xELHVFQUFzRDtBQVN0RDtJQVBBO1FBUUksV0FBTSxHQUFHLENBQUMsQ0FBQztRQUVYLGdCQUFXLEdBQUcsSUFBSSxDQUFBO1FBRWxCLFVBQUssR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFakIsT0FBRSxHQUFHLElBQUksQ0FBQztRQUVWLFdBQU0sR0FBRyxFQUFFLENBQUM7UUFFWixVQUFLLEdBQUcsT0FBTyxDQUFDO1FBRWhCLFNBQUksR0FBRyxNQUFNLENBQUM7UUFFZCxXQUFNLEdBQUcsQ0FBQyxDQUFDO1FBRVgsV0FBTSxHQUFHLENBQUMsQ0FBQztJQWlGZixDQUFDO0lBN0VHLGdDQUFRLEdBQVI7SUFFQSxDQUFDO0lBRUQsb0NBQVksR0FBWjtRQUNJLElBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RCLElBQUksQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFBO1FBQ2YsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QyxJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNsQixJQUFJLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztRQUNsQixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLHFDQUFTLEVBQUUsQ0FBQztJQUN2QyxDQUFDO0lBR0QsbUNBQVcsR0FBWDtRQUFBLGlCQTBCQztRQXpCRyxJQUFJLENBQUMsRUFBRSxHQUFHLFdBQVcsQ0FBQztZQUNsQixFQUFFLENBQUEsQ0FB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Q0FBQSxDQUFDO2dCQUM5QixJQUFJLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQztvQkFDMUIsU0FBUyxFQUFFLHNCQUFzQjtvQkFDakMsSUFBSSxFQUFFLEtBQUs7aUJBQ2QsQ0FBQyxDQUFBO2dCQUNGLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUM7Z0JBQ3hCLElBQUksQ0FBQyxNQUFNLElBQUcsRUFBRSxDQUFDO2dCQUNqQixJQUFJLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDbEMsQ0FBQztZQUFBLElBQUksQ0FBQSxDQUFDO2dCQUNGLElBQUksQ0FBQyxXQUFXLENBQUMsWUFBWSxDQUFDO29CQUMxQixTQUFTLEVBQUUsa0JBQWtCO29CQUM3QixJQUFJLEVBQUUsS0FBSztpQkFDZCxDQUFDLENBQUE7Z0JBQ0YsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQztnQkFDeEIsSUFBSSxDQUFDLE1BQU0sSUFBRyxDQUFDLENBQUM7WUFDcEIsQ0FBQztRQUNMLENBQUM7SUFDTCxDQUFDO0lBakdRLGFBQWE7UUFQekIsZ0JBQVMsQ0FBQztZQUNQLFFBQVEsRUFBRSxXQUFXO1lBQ3JCLFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRTtZQUNuQixXQUFXLEVBQUUsc0JBQXNCO1lBQ25DLFNBQVMsRUFBRSxDQUFDLHFCQUFxQixDQUFDO1NBQ3JDLENBQUM7T0FFVyxhQUFhLENBa0d6QjtJQUFELG9CQUFDO0NBQUEsQUFsR0QsSUFrR0M7QUFsR1ksc0NBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBUTlNQbGF5ZXIgfSBmcm9tICduYXRpdmVzY3JpcHQtYXVkaW8tcGxheWVyJztcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6IFwidG9wb3NfdGFnXCIsXG4gICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICB0ZW1wbGF0ZVVybDogXCJ0b3Bvcy5jb21wb25lbnQuaHRtbFwiLFxuICAgIHN0eWxlVXJsczogW1widG9wb3MuY29tcG9uZW50LmNzc1wiXVxufSlcblxuZXhwb3J0IGNsYXNzIFRvcG9Db21wb25lbnQgaW1wbGVtZW50cyBPbkluaXR7XG4gICAgcHVudG9zID0gMDtcblxuICAgIGVzdGFkb0p1ZWdvID0gdHJ1ZVxuXG4gICAgdmlkYXMgPSBBcnJheSg1KTtcblxuICAgIGlkID0gbnVsbDtcblxuICAgIGZvcmF0cyA9IFtdO1xuXG4gICAgZm9yYXQgPSBcImZvcmF0XCI7XG5cbiAgICB0b3BvID0gXCJ0b3BvXCI7XG5cbiAgICB0aWVtcG8gPSAwO1xuXG4gICAgYWx0dXJhID0gMDtcblxuICAgIHByaXZhdGUgYXVkaW9QbGF5ZXI6IFROU1BsYXllcjtcblxuICAgIG5nT25Jbml0KCl7XG4gICAgICAgIFxuICAgIH1cblxuICAgIGluaWNpYXJKdWVnbygpe1xuICAgICAgICB0aGlzLmVzdGFkb0p1ZWdvID0gZmFsc2U7XG4gICAgICAgIHRoaXMudmlkYXMgPSBBcnJheSg1KTtcbiAgICAgICAgdGhpcy5wdW50b3MgPSAwXG4gICAgICAgIHRoaXMuZm9yYXRzID0gQXJyYXkoMykuZmlsbCh0aGlzLmZvcmF0KTtcbiAgICAgICAgdGhpcy50aWVtcG8gPSA2NTA7XG4gICAgICAgIHRoaXMuYWx0dXJhID0gMjAwO1xuICAgICAgICB0aGlzLmluY2lhclRpbWVyKCk7XG5cbiAgICAgICAgdGhpcy5hdWRpb1BsYXllciA9IG5ldyBUTlNQbGF5ZXIoKTtcbiAgICB9XG5cblxuICAgIGluY2lhclRpbWVyKCl7XG4gICAgICAgIHRoaXMuaWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICBpZih0aGlzLnZpZGFzLmxlbmd0aD09MCl7XG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLmZvcmF0cy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JhdHNbaV0gPSB0aGlzLmZvcmF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuaWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuZXN0YWRvSnVlZ28gPSB0cnVlXG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb1BsYXllci5pbml0RnJvbUZpbGUoe1xuICAgICAgICAgICAgICAgICAgICBhdWRpb0ZpbGU6ICd+L2F1ZGlvL3BlcmRlci5tcDMnLFxuICAgICAgICAgICAgICAgICAgICBsb29wOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb1BsYXllci5wbGF5KCk7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBsZXQgZmlsYXMgPSBNYXRoLmZsb29yKHRoaXMucHVudG9zIC8gMTAwKTtcbiAgICAgICAgICAgICAgICBpZih0aGlzLnB1bnRvcyA+IDEwMCAmJiB0aGlzLnB1bnRvcyA8PSA3MDAgJiYgZmlsYXMgPT0gdGhpcy5mb3JhdHMubGVuZ3RoLzMpe1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcmF0cy5zcGxpY2UodGhpcy5mb3JhdHMubGVuZ3RoLTEsMCx0aGlzLmZvcmF0LHRoaXMuZm9yYXQsdGhpcy5mb3JhdCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWx0dXJhICs9IDIwMDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50aWVtcG8gLT0gNTA7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5pZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5jaWFyVGltZXIoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGV0IHBvcyA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuZm9yYXRzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jYW1iaWFyRXN0YWRvQWd1amVybyhwb3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LHRoaXMudGllbXBvKTtcbiAgICB9XG5cbiAgICBjYW1iaWFyRXN0YWRvQWd1amVybyhwb3MpIHtcbiAgICAgICAgLy90aGlzLmZvcmF0c1twb3NdID0gdGhpcy5mb3JhdHNbcG9zXT09XCJmb3JhdFwiP1widG9wb1wiOlwiZm9yYXRcIjtcbiAgICAgICAgaWYodGhpcy5mb3JhdHNbcG9zXSA9PSB0aGlzLnRvcG8pe1xuICAgICAgICAgICAgdGhpcy5mb3JhdHNbcG9zXSA9IHRoaXMuZm9yYXQ7XG4gICAgICAgICAgICBpZih0aGlzLnZpZGFzLmxlbmd0aD4wKXtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZGFzLmxlbmd0aC0tO1xuICAgICAgICAgICAgfVxuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgIHRoaXMuZm9yYXRzW3Bvc10gPSB0aGlzLnRvcG87IFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXBsYXN0YXJUb3BvKHBvcyl7XG4gICAgICAgIGlmKCF0aGlzLmVzdGFkb0p1ZWdvKXtcbiAgICAgICAgICAgIGlmKHRoaXMuZm9yYXRzW3Bvc10gPT0gdGhpcy50b3BvKXtcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvUGxheWVyLmluaXRGcm9tRmlsZSh7XG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvRmlsZTogJ34vYXVkaW8vYXBsYXN0YXIubXAzJyxcbiAgICAgICAgICAgICAgICAgICAgbG9vcDogZmFsc2VcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIHRoaXMuYXVkaW9QbGF5ZXIucGxheSgpO1xuICAgICAgICAgICAgICAgIHRoaXMucHVudG9zICs9MTU7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JhdHNbcG9zXSA9IHRoaXMuZm9yYXQ7XG4gICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICB0aGlzLmF1ZGlvUGxheWVyLmluaXRGcm9tRmlsZSh7XG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvRmlsZTogJ34vYXVkaW8vZmFpbC5tcDMnLFxuICAgICAgICAgICAgICAgICAgICBsb29wOiBmYWxzZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgdGhpcy5hdWRpb1BsYXllci5wbGF5KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wdW50b3MgLT01O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSJdfQ==